<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGE PREDIX </title>
    <link rel="icon" type="image/png" href="/favicon.png?v=3">
    <link rel="shortcut icon" href="/favicon.png?v=3">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Updated to use Inter font for body text for a more professional feel -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Cropper.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #4a6cfa;
            --primary-light: #eef0ff;
            --secondary: #ff7d4d;
            --accent: #6c63ff;
            --text: #333344;
            --text-light: #666677;
            --background: #f8f9ff;
            --card-bg: #ffffff;
            --border: #e0e5ff;
            --success: #4cc9a4;
        }

        body {
            background-color: var(--background);
            color: var(--text);
            min-height: 100vh;
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 40px;
            border-bottom: 1px solid var(--border);
            /* New styles for dynamic header */
            position: sticky;
            top: 0;
            z-index: 100;
            background-color: var(--background);
            opacity: 1; /* Initially fully visible */
            transition: opacity 0.5s ease-in-out;
        }
        
        .header.scrolled {
            opacity: 0; /* Completely transparent when scrolled */
        }
        
        .header:hover {
            opacity: 1;
        }

        .logo-container {
            display: flex;
            align-items: center;
        }

        .logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.2);
        }

        .logo i {
            font-size: 28px;
            color: white;
        }

        .brand-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--text-light);
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--primary);
        }
        
        /* Dropdown styles */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: var(--card-bg);
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
            right: 0;
            top: 100%;
            margin-top: 10px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease-in-out;
        }

        /* Class to show the dropdown */
        .dropdown-content.show {
            display: block;
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-content a {
            color: var(--text);
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            transition: background-color 0.3s;
        }

        .dropdown-content a:hover {
            background-color: var(--primary-light);
            color: var(--primary);
        }

        .nav-links a.nav-link-dropdown {
            padding-right: 25px;
        }

        /* Main Content */
        .hero {
            text-align: center;
            margin-bottom: 50px;
        }

        .hero h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text);
            line-height: 1.2;
        }

        .hero p {
            font-size: 18px;
            color: var(--text-light);
            max-width: 700px;
            margin: 0 auto 30px;
            line-height: 1.6;
        }

        .cta-button {
            background: linear-gradient(to right, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3);
            position: relative;
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(108, 99, 255, 0.4);
            animation: cta-pulse 1s forwards;
        }

        /* CTA button glow animation */
        @keyframes cta-pulse {
            0% { box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3); }
            50% { box-shadow: 0 8px 25px rgba(108, 99, 255, 0.5); }
            100% { box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3); }
        }

        /* Demo Section */
        .demo-section {
            display: flex;
            flex-direction: column;
            gap: 40px;
            margin-bottom: 60px;
            align-items: center;
        }
        
        #analysis-options-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 100%;
        }

        /* Container for the two analysis buttons */
        #analysis-options {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            width: 100%;
            max-width: 750px;
        }

        .analysis-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            width: 350px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .analysis-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .analysis-card .icon {
            font-size: 60px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .analysis-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 10px;
        }
        
        .analysis-card p {
            color: var(--text-light);
            line-height: 1.5;
        }

        /* Container for dynamic UI content */
        .analysis-ui {
            display: flex;
            flex-direction: row;
            gap: 40px;
            width: 100%;
            max-width: 1200px;
        }

        @media (max-width: 900px) {
            .analysis-ui {
                flex-direction: column;
            }
        }
        
        .upload-container, .results-container, .text-input-container {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--border);
            flex: 1;
        }
        
        .text-input-container textarea {
            width: 100%;
            height: 250px;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--border);
            resize: none;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            color: var(--text);
            background-color: var(--primary-light);
            transition: border-color 0.3s;
        }
        
        .text-input-container textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .text-input-container .input-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .text-input-container .input-controls button {
            width: 100%;
        }

        .section-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 25px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--primary);
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: color 0.3s;
        }

        .back-btn:hover {
            color: var(--primary);
        }
        
        /* Upload Area and Webcam styles */
        .upload-area {
            border: 2px dashed var(--border);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--primary-light);
            position: relative; /* Needed for drag and drop overlay */
        }
        
        .upload-area.drag-over {
            border-color: var(--primary);
            background: rgba(74, 108, 250, 0.1);
        }

        .upload-icon {
            font-size: 50px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--text-light);
        }

        .upload-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 14px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .upload-btn:hover {
            background: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3);
        }

        .webcam-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
        }
        
        .webcam-container video {
            width: 100%;
            max-width: 400px;
            height: auto;
            border-radius: 15px;
            margin-bottom: 15px;
            background-color: #000;
        }
        
        .webcam-btn, .webcam-close-btn {
            background: white;
            color: var(--primary);
            border: 1px solid var(--primary);
            padding: 10px 25px;
            font-size: 14px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .webcam-btn:hover, .webcam-close-btn:hover {
            background: var(--primary-light);
        }
        
        .toggle-webcam-btn {
            background: #e0e5ff;
            color: var(--primary);
            border: 1px solid var(--border);
            padding: 10px 25px;
            font-size: 14px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }
        
        .toggle-webcam-btn:hover {
            background: var(--border);
        }

        /* Results Section */
        .results-display {
            text-align: center;
            padding: 20px;
        }
        
        .image-preview {
            max-width: 100%;
            height: auto;
            max-height: 250px;
            border-radius: 15px;
            margin: 0 auto 20px auto;
            display: none;
            object-fit: contain;
        }
        
        /* Style for the loading state */
        .age-result.loading {
            color: var(--text-light);
        }
        
        /* Loading spinner animation */
        .age-result.loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-left: 10px;
            border: 3px solid var(--primary);
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .age-result {
            font-size: 72px;
            font-weight: 700;
            color: var(--primary);
            margin: 20px 0;
            font-family: 'Montserrat', sans-serif;
        }

        .confidence {
            font-size: 18px;
            color: var(--text-light);
            margin-bottom: 30px;
        }

        .age-bar {
            height: 20px;
            background: var(--primary-light);
            border-radius: 10px;
            margin: 30px 0;
            overflow: hidden;
            position: relative;
        }

        .age-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 10px;
            width: 0%; /* Initial width for animation */
            position: absolute;
            top: 0;
            left: 0;
            transition: width 0.3s ease;
        }
        
        /* Added a dynamic class for the animated progress bar */
        .age-fill.animating {
            animation: progress 2s forwards;
        }

        @keyframes progress {
            from { width: 0%; }
            to { width: var(--final-width); }
        }

        .features-analysis {
            text-align: left;
            margin-top: 30px;
        }

        .feature-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .feature-name {
            color: var(--text-light);
        }

        .feature-value {
            color: var(--primary);
            font-weight: 500;
        }

        /* Features Section */
        .features-section {
            margin: 60px 0;
        }

        .features-title {
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 50px;
            color: var(--text);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
        }
        
        .feature-detail-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .feature-detail-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .feature-detail-card h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text);
        }

        .feature-detail-card p {
            color: var(--text-light);
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .features-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .feature-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            width: 70px;
            height: 70px;
            background: var(--primary-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            color: var(--primary);
            font-size: 28px;
        }

        .feature-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text);
        }

        .feature-desc {
            color: var(--text-light);
            line-height: 1.6;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 0;
            margin-top: 60px;
            border-top: 1px solid var(--border);
            color: var(--text-light);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }

        .footer-links a {
            color: var(--text-light);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        /* Animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animated {
            animation: fadeIn 0.8s ease forwards;
        }

        .delay-1 {
            animation-delay: 0.2s;
        }

        .delay-2 {
            animation-delay: 0.4s;
        }

        .delay-3 {
            animation-delay: 0.6s;
        }

        /* Pulse animation for results */
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Image Cropping Modal Styles */
        .crop-modal {
            display: none;
            position: fixed;
            z-index: 3000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .crop-modal-content {
            background-color: var(--card-bg);
            margin: 2% auto;
            padding: 30px;
            border: 1px solid var(--border);
            width: 90%;
            max-width: 800px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            position: relative;
            transform: scale(0.95);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        
        .crop-modal.show .crop-modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .crop-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .crop-header h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin: 0;
        }

        .crop-close {
            color: var(--text-light);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }

        .crop-close:hover {
            color: var(--primary);
        }

        .crop-container {
            max-height: 400px;
            margin-bottom: 20px;
            overflow: hidden;
            border-radius: 10px;
        }

        .crop-container img {
            max-width: 100%;
            display: block;
        }

        .crop-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .crop-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 14px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .crop-btn:hover {
            background: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3);
        }

        .crop-btn.secondary {
            background: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .crop-btn.secondary:hover {
            background: var(--primary-light);
        }

        /* Custom Message Box */
        .message-box {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(51, 51, 68, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .message-box.show {
            opacity: 1;
            visibility: visible;
        }

        /* About Us Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: var(--card-bg);
            margin: 5% auto;
            padding: 40px;
            border: 1px solid var(--border);
            width: 80%;
            max-width: 800px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            transform: scale(0.95);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }
        
        .modal.show .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
        }

        .modal-close {
            color: var(--text-light);
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: var(--primary);
        }

        .modal-body h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 20px;
            font-weight: 600;
            color: var(--text);
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .modal-body p {
            font-size: 16px;
            color: var(--text-light);
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .modal-body ul {
            list-style-type: none;
            padding: 0;
            margin-bottom: 20px;
        }

        .modal-body ul li {
            position: relative;
            padding-left: 25px;
            margin-bottom: 10px;
            color: var(--text-light);
            line-height: 1.6;
        }

        .modal-body ul li::before {
            content: "\f058";
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            color: var(--success);
            position: absolute;
            left: 0;
            top: 0;
        }
        
        .api-code-block {
            background-color: #f1f1f1;
            padding: 15px;
            border-radius: 10px;
            text-align: left;
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        /* Contact form specific styles */
        .contact-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .contact-form input,
        .contact-form textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .contact-form input:focus,
        .contact-form textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 5px rgba(74, 108, 250, 0.3);
        }

        .contact-form textarea {
            min-height: 150px;
            resize: vertical;
        }

        .contact-form .send-btn {
            background: linear-gradient(to right, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.3);
        }

        .contact-form .send-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(108, 99, 255, 0.4);
        }

        /* Mobile Media Queries */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            /* Header Mobile Styles */
            .header {
                flex-direction: column;
                gap: 20px;
                padding: 15px 0;
                position: relative;
            }

            .logo-container {
                justify-content: center;
            }

            .logo {
                width: 50px;
                height: 50px;
                margin-right: 10px;
            }

            .logo i {
                font-size: 24px;
            }

            .brand-name {
                font-size: 24px;
            }

            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
            }

            .nav-links a {
                font-size: 14px;
            }

            /* Hero Section Mobile */
            .hero h1 {
                font-size: 28px;
                line-height: 1.3;
            }

            .hero p {
                font-size: 16px;
                padding: 0 10px;
            }

            .cta-button {
                padding: 12px 30px;
                font-size: 14px;
            }

            /* Analysis Options Mobile */
            #analysis-options {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }

            .analysis-card {
                width: 100%;
                max-width: 300px;
                padding: 25px;
            }

            .analysis-card .icon {
                font-size: 50px;
            }

            .analysis-card h3 {
                font-size: 20px;
            }

            /* Demo Section Mobile */
            .analysis-ui {
                flex-direction: column;
                gap: 20px;
            }

            .upload-container, .results-container, .text-input-container {
                padding: 20px;
            }

            .section-title {
                font-size: 18px;
                text-align: center;
            }

            /* Upload Area Mobile */
            .upload-area {
                padding: 30px 15px;
            }

            .upload-icon {
                font-size: 40px;
            }

            .upload-text {
                font-size: 14px;
            }

            .upload-btn, .webcam-btn, .crop-btn {
                padding: 10px 20px;
                font-size: 12px;
            }

            /* Results Mobile */
            .age-result {
                font-size: 48px;
            }

            .confidence {
                font-size: 16px;
            }

            .image-preview {
                max-height: 200px;
            }

            /* Text Input Mobile */
            .text-input-container textarea {
                height: 200px;
                font-size: 14px;
            }

            /* Features Grid Mobile */
            .features-title {
                font-size: 24px;
            }

            .features-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .feature-detail-card, .feature-card {
                padding: 20px;
            }

            .feature-detail-card h3, .feature-title {
                font-size: 18px;
            }

            /* Cropping Modal Mobile */
            .crop-modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 20px;
            }

            .crop-header h2 {
                font-size: 20px;
            }

            .crop-container {
                max-height: 300px;
            }

            .crop-controls {
                flex-direction: column;
                gap: 10px;
            }

            .crop-btn {
                width: 100%;
                justify-content: center;
            }

            /* Contact Modal Mobile */
            .modal-content {
                width: 95%;
                margin: 5% auto;
                padding: 25px;
            }

            .modal-header h2 {
                font-size: 22px;
            }

            .contact-form input,
            .contact-form textarea {
                font-size: 14px;
            }

            /* Footer Mobile */
            .footer {
                padding: 30px 0;
                text-align: center;
            }

            .footer-links {
                flex-direction: column;
                gap: 15px;
                margin-bottom: 15px;
            }

            /* Dropdown Mobile */
            .dropdown-content {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 80%;
                max-width: 250px;
            }

            /* Message Box Mobile */
            .message-box {
                bottom: 10px;
                left: 10px;
                right: 10px;
                transform: none;
                width: auto;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .hero h1 {
                font-size: 24px;
            }

            .hero p {
                font-size: 14px;
            }

            .analysis-card {
                padding: 20px;
            }

            .analysis-card .icon {
                font-size: 40px;
            }

            .analysis-card h3 {
                font-size: 18px;
            }

            .upload-container, .results-container, .text-input-container {
                padding: 15px;
            }

            .section-title {
                font-size: 16px;
            }

            .age-result {
                font-size: 36px;
            }

            .crop-modal-content, .modal-content {
                padding: 15px;
            }

            .features-title {
                font-size: 20px;
            }

            .brand-name {
                font-size: 20px;
            }

            .logo {
                width: 40px;
                height: 40px;
            }

            .logo i {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- New message box element -->
        <div id="messageBox" class="message-box"></div>
        
        <!-- About Us Modal -->
        <div id="aboutUsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>About Us</h2>
                    <span class="modal-close" id="closeAboutModalBtn">&times;</span>
                </div>
                <div class="modal-body">
                    <h3>Pioneering the Future of Age Prediction</h3>
                    <p>
                        At AGE PREDIX, we're transforming the way age is predicted by leveraging cutting-edge technology to solve a critical, real-world problem. Traditional age verification methods are often invasive, inefficient, and prone to error, leading to regulatory non-compliance, poor user experiences, and significant security risks. We saw a need for a solution that is both highly accurate and user-friendly, and that's exactly what we've built.
                    </p>
                    <h3>Our Mission</h3>
                    <p>
                        Our mission is to provide businesses and organizations with a non-intrusive, accurate, and secure age prediction platform. We empower our clients to ensure regulatory compliance, deliver personalized content, and enhance security, all while prioritizing user privacy. By moving beyond traditional, manual processes, we're helping to create a safer and more seamless digital and physical world.
                    </p>
                    <h3>What We Do</h3>
                    <p>
                        We specialize in developing sophisticated age prediction models that analyze various data inputs, including images, text, and voice. Our core technology is built on state-of-the-art machine learning and computer vision algorithms, allowing us to estimate an individual's age with remarkable precision.
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Image Cropping Modal -->
        <div id="cropModal" class="crop-modal">
            <div class="crop-modal-content">
                <div class="crop-header">
                    <h2><i class="fas fa-crop"></i> Crop Your Image</h2>
                    <span class="crop-close" id="closeCropModalBtn">&times;</span>
                </div>
                <div class="crop-container">
                    <img id="cropImage" src="" alt="Image to crop">
                </div>
                <div class="crop-controls">
                    <button id="cropConfirmBtn" class="crop-btn">
                        <i class="fas fa-check"></i> Use Cropped Image
                    </button>
                    <button id="cropCancelBtn" class="crop-btn secondary">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button id="cropResetBtn" class="crop-btn secondary">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                </div>
            </div>
        </div>

        <!-- Contact Modal -->
        <div id="contactModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Contact Us</h2>
                    <span class="modal-close" id="closeContactModalBtn">&times;</span>
                </div>
                <div class="modal-body">
                    <form class="contact-form" id="contactForm">
                        <input type="text" id="contactName" placeholder="Your Name" required>
                        <input type="email" id="contactEmail" placeholder="Your Email" required>
                        <input type="text" id="contactSubject" placeholder="Subject" required>
                        <textarea id="contactMessage" placeholder="Your Message" required></textarea>
                        <button type="submit" class="send-btn">SEND MESSAGE</button>
                    </form>
                </div>
            </div>
        </div>

        <header class="header" id="dynamicHeader">
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                </div>
                <div class="brand-name">AGE PREDIX</div>
            </div>
            <nav class="nav-links">
                <a href="#" id="homeLink">Home</a>
                <a href="#" id="aboutUsLink">About Us</a>
                <a href="#services-features-section" id="servicesFeaturesLink">Services & Features</a>
                <!-- Updated 'How It Works' link to scroll to the section -->
                <a href="#how-it-works" id="howItWorksLink">How It Works</a>
                <div class="dropdown">
                    <a href="#" class="nav-link-dropdown" id="contactLink">Contact <i class="fas fa-caret-down"></i></a>
                    <div class="dropdown-content">
                        <!-- Updated to use a modal pop-up for the contact form -->
                        <a href="#" id="emailContactLink">Email</a>
                    </div>
                </div>
            </nav>
        </header>

        <section class="hero">
            <h1>Advanced AI-Powered Age Prediction</h1>
            <p>Our cutting-edge technology analyzes facial features to accurately predict age with state-of-the-art neural networks and computer vision algorithms.</p>
            <!-- Added ID for CTA button to link with smooth scroll -->
            <a href="#demo-section" id="ctaBtn"><button class="cta-button">Try It Now</button></a>
        </section>

        <!-- The main demo section with the new UI flow -->
        <section class="demo-section" id="demo-section">
            <!-- Initial screen with analysis options -->
            <div id="analysis-options-container" class="animated">
                <h2 class="features-title">Choose an Analysis Type</h2>
                <div id="analysis-options">
                    <div class="analysis-card" id="imageAnalysisBtn">
                        <i class="icon fas fa-camera"></i>
                        <h3>Image Analysis</h3>
                        <p>Upload an image or use your webcam to predict age based on facial features.</p>
                    </div>
                    <div class="analysis-card" id="textAnalysisBtn">
                        <i class="icon fas fa-file-alt"></i>
                        <h3>Text Analysis</h3>
                        <p>Analyze text to predict the author's age based on linguistic style and patterns.</p>
                    </div>
                </div>
            </div>
            
            <!-- Image analysis UI (hidden by default) -->
            <div id="image-analysis-ui" class="analysis-ui" style="display: none;">
                <div class="upload-container animated">
                    <button class="back-btn" id="imageBackBtn"><i class="fas fa-arrow-left"></i> Back to Options</button>
                    <h2 class="section-title"><i class="fas fa-upload"></i> Upload Image</h2>
                    <input type="file" id="imageFileInput" accept="image/*" style="display: none;">
                    <div class="upload-area">
                        <i class="upload-icon fas fa-cloud-upload-alt"></i>
                        <p class="upload-text">Drag & Drop your image here</p>
                        <p class="upload-text">or</p>
                        <button class="upload-btn">BROWSE FILES</button>
                    </div>

                    <div class="webcam-container">
                        <p class="upload-text">Alternatively, use your camera</p>
                        <video id="webcamVideo" style="display: none;" autoplay></video>
                        <canvas id="webcamCanvas" style="display: none;"></canvas>
                        <div id="webcam-controls" style="display: none; flex-direction: column; align-items: center; gap: 10px;">
                            <button id="captureBtn" class="webcam-btn"><i class="fas fa-camera"></i> Capture Photo</button>
                            <button id="closeWebcamBtn" class="webcam-close-btn"><i class="fas fa-times"></i> Close Camera</button>
                        </div>
                        <button id="webcamBtn" class="webcam-btn"><i class="fas fa-camera"></i> CAPTURE IMAGE</button>
                    </div>
                </div>
                <div class="results-container animated">
                    <h2 class="section-title"><i class="fas fa-chart-line"></i> Analysis Results</h2>
                    <div class="results-display">
                        <!-- Content will be generated dynamically here -->
                    </div>
                </div>
            </div>

            <!-- Text analysis UI (hidden by default) -->
            <div id="text-analysis-ui" class="analysis-ui" style="display: none;">
                <div class="text-input-container animated">
                    <button class="back-btn" id="textBackBtn"><i class="fas fa-arrow-left"></i> Back to Options</button>
                    <h2 class="section-title"><i class="fas fa-file-alt"></i> Enter Text for Analysis</h2>
                    <p class="upload-text">Enter text or browse a file below.</p>
                    <textarea id="textInput" placeholder="Enter your text here... (minimum 50 characters for better accuracy)"></textarea>
                    <div class="input-controls" style="margin-top: 20px;">
                        <button id="analyzeTextBtn" class="upload-btn">
                            <i class="fas fa-search"></i> Analyze Text
                        </button>
                        <button id="browseTextBtn" class="upload-btn" style="background: white; color: var(--primary); border: 1px solid var(--primary);">
                            <i class="fas fa-file-upload"></i> Browse Text File
                        </button>
                    </div>
                    <input type="file" id="textFileInput" accept=".txt,.doc,.docx" style="display: none;">
                </div>
                <div class="results-container animated">
                    <h2 class="section-title"><i class="fas fa-chart-line"></i> Analysis Results</h2>
                    <div id="textResultsDisplay" class="results-display">
                        <p class="upload-text">Upload text to see age prediction results here.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- New section for Services & Features -->
        <section class="features-section" id="services-features-section">
            <h2 class="features-title">Services & Features</h2>
            <div class="features-grid">
                <div class="feature-detail-card animated delay-1">
                    <div class="feature-icon">
                        <i class="fas fa-plug"></i>
                    </div>
                    <h3 class="feature-title">API Integration</h3>
                    <p class="feature-desc">
                        Easily integrate our powerful age prediction API into your existing applications, websites, or software. Our well-documented API and developer-friendly tools ensure a seamless and quick setup process.
                    </p>
                </div>
                <div class="feature-detail-card animated delay-2">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3 class="feature-title">Non-Intrusive Verification</h3>
                    <p class="feature-desc">
                        Prioritize user privacy with our non-intrusive age verification method. We analyze facial features without collecting or storing personally identifiable information, providing a secure and anonymous experience for your users.
                    </p>
                </div>
                <div class="feature-detail-card animated delay-3">
                    <div class="feature-icon">
                        <i class="fas fa-ban"></i>
                    </div>
                    <h3 class="feature-title">Age-Gating for Content</h3>
                    <p class="feature-desc">
                        Ensure regulatory compliance by implementing age-gating for content or services. Our technology provides accurate age estimates, helping you restrict access to age-sensitive materials and protect your audience.
                    </p>
                </div>
            </div>
        </section>


        <!-- New and detailed 'How It Works' section -->
        <section class="features-section" id="how-it-works">
            <h2 class="features-title">How It Works</h2>
            <div class="features-grid">
                <!-- Step 1: Image Upload -->
                <div class="feature-detail-card animated delay-1">
                    <div class="feature-icon">
                        <i class="fas fa-upload"></i>
                    </div>
                    <h3 class="feature-title">Step 1: Upload Your Image</h3>
                    <p class="feature-desc">
                        To begin, simply upload a clear facial image from your computer or use your webcam to capture a photo in real-time. Our system is optimized to work with a variety of image formats, ensuring a smooth and effortless start to the analysis process.
                    </p>
                </div>

                <!-- Step 2: AI-Powered Facial Analysis -->
                <div class="feature-detail-card animated delay-2">
                    <div class="feature-icon">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <h3 class="feature-title">Step 2: AI-Powered Facial Analysis</h3>
                    <p class="feature-desc">
                        Once the image is uploaded, our advanced AI-powered neural network immediately gets to work. It meticulously analyzes hundreds of data points on the face, including skin texture, wrinkle patterns, facial symmetry, and bone structure, to identify subtle, age-related markers.
                    </p>
                </div>

                <!-- Step 3: Get Your Detailed Results -->
                <div class="feature-detail-card animated delay-3">
                    <div class="feature-icon">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <h3 class="feature-title">Step 3: Get Your Detailed Results</h3>
                    <p class="feature-desc">
                        In just a few moments, you will receive a highly accurate age prediction. The results are presented in a clear, easy-to-read format, complete with a confidence score and a breakdown of key facial features that influenced the prediction, giving you a comprehensive analysis.
                    </p>
                </div>
            </div>
        </section>

        <footer class="footer">
            <!-- <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
                <a href="#">API Documentation</a>
                <a href="#">Contact Us</a>
            </div> -->
            <p>Â© 2026 AGE PREDIX | Age Prediction Technology</p>
            <p style="margin-top: 10px; font-weight: 600; color: var(--primary);">Developed by Team HUSTLERS</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Dropdown functionality with delay
            const dropdown = document.querySelector('.dropdown');
            const dropdownContent = document.querySelector('.dropdown-content');
            let timeout;

            // Show dropdown on hover
            dropdown.addEventListener('mouseenter', () => {
                clearTimeout(timeout);
                dropdownContent.classList.add('show');
            });

            // Hide dropdown with a 0.5-second delay
            dropdown.addEventListener('mouseleave', () => {
                timeout = setTimeout(() => {
                    dropdownContent.classList.remove('show');
                }, 500); // 500 milliseconds = 0.5 seconds
            });

            // Keep dropdown visible if the mouse enters the dropdown content itself
            dropdownContent.addEventListener('mouseenter', () => {
                clearTimeout(timeout);
            });

            // Hide dropdown with delay when leaving the dropdown content
            dropdownContent.addEventListener('mouseleave', () => {
                timeout = setTimeout(() => {
                    dropdownContent.classList.remove('show');
                }, 500); // 500 milliseconds = 0.5 seconds
            });
            
            // --- About Us Modal functionality ---
            const aboutUsLink = document.getElementById('aboutUsLink');
            const aboutUsModal = document.getElementById('aboutUsModal');
            const closeAboutModalBtn = document.getElementById('closeAboutModalBtn');
            
            aboutUsLink.addEventListener('click', (e) => {
                e.preventDefault();
                aboutUsModal.style.display = 'flex';
                // Add a small delay to trigger the transition
                setTimeout(() => {
                    aboutUsModal.classList.add('show');
                    // Lock the body scroll
                    document.body.style.overflow = 'hidden';
                }, 10);
            });
            
            closeAboutModalBtn.addEventListener('click', () => {
                aboutUsModal.classList.remove('show');
                setTimeout(() => {
                    aboutUsModal.style.display = 'none';
                    // Restore the body scroll
                    document.body.style.overflow = 'auto';
                }, 300); // Match this delay with the CSS transition duration
            });
            
            // Close the modal when clicking outside of it
            window.addEventListener('click', (e) => {
                if (e.target === aboutUsModal) {
                    aboutUsModal.classList.remove('show');
                    setTimeout(() => {
                        aboutUsModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }, 300);
                }
            });

            // --- Contact Modal functionality ---
            const emailContactLink = document.getElementById('emailContactLink');
            const contactModal = document.getElementById('contactModal');
            const closeContactModalBtn = document.getElementById('closeContactModalBtn');
            const contactForm = document.getElementById('contactForm');
            const contactName = document.getElementById('contactName');
            const contactEmail = document.getElementById('contactEmail');
            const contactSubject = document.getElementById('contactSubject');
            const contactMessage = document.getElementById('contactMessage');
            
            emailContactLink.addEventListener('click', (e) => {
                e.preventDefault();
                contactModal.style.display = 'flex';
                setTimeout(() => {
                    contactModal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                }, 10);
            });
            
            closeContactModalBtn.addEventListener('click', () => {
                contactModal.classList.remove('show');
                setTimeout(() => {
                    contactModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }, 300);
            });
            
            window.addEventListener('click', (e) => {
                if (e.target === contactModal) {
                    contactModal.classList.remove('show');
                    setTimeout(() => {
                        contactModal.style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }, 300);
                }
            });
            
            contactForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                // Get form data
                const formData = {
                    name: contactName.value,
                    email: contactEmail.value,
                    subject: contactSubject.value,
                    message: contactMessage.value
                };
                
                // Disable submit button and show loading state
                const submitBtn = contactForm.querySelector('.send-btn');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'SENDING...';
                submitBtn.disabled = true;
                
                try {
                    // Send email via API
                    const response = await fetch('/contact', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(formData)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok && result.success) {
                        showMessage("Thank you for your message! We'll be in touch shortly.");
                        contactForm.reset();
                        contactModal.classList.remove('show');
                        setTimeout(() => {
                            contactModal.style.display = 'none';
                            document.body.style.overflow = 'auto';
                        }, 300);
                    } else {
                        showMessage(result.message || "Failed to send message. Please try again.", 5000);
                    }
                } catch (error) {
                    console.error('Error sending email:', error);
                    showMessage("Failed to send message. Please check your connection and try again.", 5000);
                } finally {
                    // Reset button state
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                }
            });


            // --- Smooth scrolling for navigation links ---
            const homeLink = document.getElementById('homeLink');
            const howItWorksLink = document.getElementById('howItWorksLink');
            const servicesFeaturesLink = document.getElementById('servicesFeaturesLink');
            const ctaBtn = document.getElementById('ctaBtn');
            const demoSection = document.getElementById('demo-section');
            const header = document.getElementById('dynamicHeader');

            function smoothScroll(targetId) {
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            }
            
            // New scroll event listener for header opacity
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });

            homeLink.addEventListener('click', function(e) {
                e.preventDefault();
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });

            howItWorksLink.addEventListener('click', function(e) {
                e.preventDefault();
                smoothScroll('how-it-works');
            });

            servicesFeaturesLink.addEventListener('click', function(e) {
                e.preventDefault();
                smoothScroll('services-features-section');
            });

            // Smooth scroll for CTA button
            ctaBtn.addEventListener('click', (e) => {
                e.preventDefault();
                smoothScroll('demo-section');
            });

            // --- UI Navigation and State Management ---
            const analysisOptionsContainer = document.getElementById('analysis-options-container');
            const imageAnalysisBtn = document.getElementById('imageAnalysisBtn');
            const textAnalysisBtn = document.getElementById('textAnalysisBtn');
            const imageAnalysisUI = document.getElementById('image-analysis-ui');
            const textAnalysisUI = document.getElementById('text-analysis-ui');
            const imageBackBtn = document.getElementById('imageBackBtn');
            const textBackBtn = document.getElementById('textBackBtn');

            function showAnalysisUI(uiId) {
                analysisOptionsContainer.style.display = 'none';
                if (uiId === 'image') {
                    imageAnalysisUI.style.display = 'flex';
                } else if (uiId === 'text') {
                    textAnalysisUI.style.display = 'flex';
                }
                demoSection.scrollIntoView({ behavior: 'smooth' });
            }

            function hideAnalysisUIs() {
                imageAnalysisUI.style.display = 'none';
                textAnalysisUI.style.display = 'none';
                analysisOptionsContainer.style.display = 'flex';
            }

            imageAnalysisBtn.addEventListener('click', () => showAnalysisUI('image'));
            textAnalysisBtn.addEventListener('click', () => showAnalysisUI('text'));
            imageBackBtn.addEventListener('click', hideAnalysisUIs);
            textBackBtn.addEventListener('click', hideAnalysisUIs);

            // --- Image Upload and Webcam functionality (specific to image-analysis-ui) ---
            const uploadArea = imageAnalysisUI.querySelector('.upload-area');
            const fileInput = document.getElementById('imageFileInput');
            const uploadBtn = uploadArea.querySelector('.upload-btn');
            const webcamBtn = document.getElementById('webcamBtn');
            const captureBtn = document.getElementById('captureBtn');
            const webcamVideo = document.getElementById('webcamVideo');
            const webcamCanvas = document.getElementById('webcamCanvas');
            const messageBox = document.getElementById('messageBox');
            const webcamControls = document.getElementById('webcam-controls');
            const closeWebcamBtn = document.getElementById('closeWebcamBtn');
            const resultsDisplay = imageAnalysisUI.querySelector('.results-display');
            let videoStream;

            // Cropping modal elements
            const cropModal = document.getElementById('cropModal');
            const cropImage = document.getElementById('cropImage');
            const closeCropModalBtn = document.getElementById('closeCropModalBtn');
            const cropConfirmBtn = document.getElementById('cropConfirmBtn');
            const cropCancelBtn = document.getElementById('cropCancelBtn');
            const cropResetBtn = document.getElementById('cropResetBtn');
            let cropper = null;
            let currentImageFile = null;

            // Show a custom message box instead of an alert
            function showMessage(message, duration = 3000) {
                messageBox.textContent = message;
                messageBox.classList.add('show');
                setTimeout(() => {
                    messageBox.classList.remove('show');
                }, duration);
            }

            // Function to render the results dynamically
            function renderResults(imageDataURL, age, confidence, features, container, gender = null) {
                const genderDisplay = gender ? `
                    <div style="margin: 20px 0; padding: 15px; background: var(--primary-light); border-radius: 10px;">
                        <p class="confidence" style="margin-bottom: 10px;">Predicted Gender</p>
                        <div style="font-size: 36px; font-weight: 700; color: var(--primary); margin-bottom: 10px;">
                            ${gender.predicted_gender.toUpperCase()}
                        </div>
                        <p class="confidence">Confidence: ${Math.round(gender.confidence * 100)}%</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 14px;">
                            <span>Female: ${Math.round(gender.probabilities.female * 100)}%</span>
                            <span>Male: ${Math.round(gender.probabilities.male * 100)}%</span>
                        </div>
                    </div>
                ` : '';

                container.innerHTML = `
                    <img id="imagePreview" class="image-preview" src="${imageDataURL}" alt="Uploaded or captured image preview" style="display: block;">
                    <p class="confidence">Predicted Age</p>
                    <div class="age-result">${age}</div>
                    <p class="confidence">Confidence: ${confidence}%</p>
                    <div class="age-bar">
                        <div class="age-fill" style="width: 0%;" id="animatedAgeFill"></div>
                    </div>
                    ${genderDisplay}
                    <div class="features-analysis">
                        ${features.map(f => `
                            <div class="feature-item">
                                <span class="feature-name">${f.name}</span>
                                <span class="feature-value">${f.value}% match</span>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                // Animate the progress bar after rendering
                const animatedAgeFill = document.getElementById('animatedAgeFill');
                animatedAgeFill.style.setProperty('--final-width', `${confidence}%`);
                animatedAgeFill.style.width = `${confidence}%`;
            }

            function processImageFile(file) {
                if (file && file.type.startsWith('image/')) {
                    currentImageFile = file;
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const imageDataURL = e.target.result;
                        showCropModal(imageDataURL);
                    };
                    reader.readAsDataURL(file);
                }
            }

            // Show cropping modal
            function showCropModal(imageDataURL) {
                cropImage.src = imageDataURL;
                cropModal.style.display = 'flex';
                setTimeout(() => {
                    cropModal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                    
                    // Initialize cropper after modal is shown
                    if (cropper) {
                        cropper.destroy();
                    }
                    cropper = new Cropper(cropImage, {
                        aspectRatio: 1, // Square crop for better face detection
                        viewMode: 1,
                        dragMode: 'move',
                        autoCropArea: 0.8,
                        restore: false,
                        guides: true,
                        center: true,
                        highlight: false,
                        cropBoxMovable: true,
                        cropBoxResizable: true,
                        toggleDragModeOnDblclick: false,
                    });
                }, 10);
            }

            // Hide cropping modal
            function hideCropModal() {
                cropModal.classList.remove('show');
                setTimeout(() => {
                    cropModal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                    if (cropper) {
                        cropper.destroy();
                        cropper = null;
                    }
                }, 300);
            }

            // Cropping modal event listeners
            closeCropModalBtn.addEventListener('click', hideCropModal);
            cropCancelBtn.addEventListener('click', hideCropModal);

            cropResetBtn.addEventListener('click', () => {
                if (cropper) {
                    cropper.reset();
                }
            });

            cropConfirmBtn.addEventListener('click', () => {
                if (cropper) {
                    const canvas = cropper.getCroppedCanvas({
                        width: 400,
                        height: 400,
                        imageSmoothingEnabled: true,
                        imageSmoothingQuality: 'high',
                    });
                    
                    const croppedImageDataURL = canvas.toDataURL('image/jpeg', 0.9);
                    hideCropModal();
                    predictAge(croppedImageDataURL);
                }
            });

            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === cropModal) {
                    hideCropModal();
                }
            });

            // Drag and Drop functionality
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('drag-over');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    processImageFile(files[0]);
                }
            });

            // File selection via button
            uploadBtn.addEventListener('click', () => {
                fileInput.click();
            });

            fileInput.addEventListener('change', (e) => {
                const files = e.target.files;
                if (files.length > 0) {
                    processImageFile(files[0]);
                }
            });

            // Webcam functionality
            webcamBtn.addEventListener('click', async () => {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                    videoStream = stream;
                    webcamVideo.srcObject = stream;
                    webcamVideo.style.display = 'block';
                    webcamControls.style.display = 'flex'; // Show both capture and close buttons
                    webcamBtn.style.display = 'none';
                    uploadArea.style.display = 'none';
                    resultsDisplay.innerHTML = ''; // Clear previous results
                    showMessage("Webcam enabled. Please capture a photo.");
                } catch (err) {
                    console.error("Error accessing webcam: ", err);
                    showMessage("Could not access the webcam. Please ensure you have granted permission.", 5000);
                }
            });
            
            // Function to stop webcam and return to initial state
            function closeWebcam() {
                if (videoStream) {
                    videoStream.getTracks().forEach(track => track.stop());
                }
                webcamVideo.style.display = 'none';
                webcamControls.style.display = 'none';
                webcamBtn.style.display = 'block';
                uploadArea.style.display = 'block';
            }
            
            closeWebcamBtn.addEventListener('click', closeWebcam);

            captureBtn.addEventListener('click', () => {
                const context = webcamCanvas.getContext('2d');
                webcamCanvas.width = webcamVideo.videoWidth;
                webcamCanvas.height = webcamVideo.videoHeight;
                context.drawImage(webcamVideo, 0, 0, webcamCanvas.width, webcamCanvas.height);
                const imageDataURL = webcamCanvas.toDataURL('image/jpeg');

                closeWebcam(); // Close the webcam after capturing the image

                // Show cropping modal for webcam captured image
                showCropModal(imageDataURL);
            });
            
            // Function to dynamically generate the loading state
            function renderLoadingState(imageDataURL) {
                resultsDisplay.innerHTML = `
                    <img id="imagePreview" class="image-preview" src="${imageDataURL}" alt="Uploaded or captured image preview" style="display: block;">
                    <p class="confidence">Predicted Age</p>
                    <div class="age-result loading">...</div>
                    <p class="confidence">Analyzing...</p>
                    <div class="age-bar">
                        <div class="age-fill" style="width: 0%;"></div>
                    </div>
                    <div class="features-analysis">
                        <div class="feature-item">
                            <span class="feature-name">Skin Texture</span>
                            <span class="feature-value">...</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-name">Facial Structure</span>
                            <span class="feature-value">...</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-name">Feature Spacing</span>
                            <span class="feature-value">...</span>
                        </div>
                    </div>
                `;
            }
            
            // Real age prediction function that calls the unified API
            async function predictAge(imageDataURL, isWebcamCapture = false) {
                renderLoadingState(imageDataURL);
                
                try {
                    let formData = new FormData();
                    
                    if (isWebcamCapture) {
                        // For webcam captures, convert data URL to blob
                        const response = await fetch(imageDataURL);
                        const blob = await response.blob();
                        formData.append('file', blob, 'webcam_capture.jpg');
                    } else {
                        // For file uploads, convert data URL to blob
                        const response = await fetch(imageDataURL);
                        const blob = await response.blob();
                        formData.append('file', blob, 'image.jpg');
                    }
                    
                    // Make API call to unified backend
                    const apiResponse = await fetch('/predict/image', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!apiResponse.ok) {
                        throw new Error(`HTTP error! status: ${apiResponse.status}`);
                    }
                    
                    const result = await apiResponse.json();
                    
                    const confidence = Math.round(parseFloat(result.confidence) * 100);
                    const features = [
                        { name: "Skin Texture", value: Math.floor(Math.random() * 10) + 85 },
                        { name: "Facial Structure", value: Math.floor(Math.random() * 10) + 85 },
                        { name: "Feature Spacing", value: Math.floor(Math.random() * 10) + 85 }
                    ];
                    
                    // Extract gender information if available
                    const genderInfo = result.gender && !result.gender.error ? result.gender : null;
                    
                    renderResults(imageDataURL, result.predicted_age_group, confidence, features, resultsDisplay, genderInfo);
                    
                    // Add pulse animation to the final result
                    const ageResultElement = resultsDisplay.querySelector('.age-result');
                    if (ageResultElement) {
                        ageResultElement.classList.add('pulse');
                        setTimeout(() => {
                            ageResultElement.classList.remove('pulse');
                        }, 2000);
                    }
                    
                } catch (error) {
                    console.error('Error predicting age:', error);
                    resultsDisplay.innerHTML = `
                        <img id="imagePreview" class="image-preview" src="${imageDataURL}" alt="Uploaded image" style="display: block;">
                        <p class="confidence" style="color: #ff4444;">Error</p>
                        <div class="age-result" style="color: #ff4444;">Failed to predict age</div>
                        <p class="confidence" style="color: #ff4444;">${error.message}</p>
                    `;
                    showMessage('Error: ' + error.message, 5000);
                }
            }

            // --- Text Analysis functionality (specific to text-analysis-ui) ---
            const textInput = document.getElementById('textInput');
            const browseTextBtn = document.getElementById('browseTextBtn');
            const textFileInput = document.getElementById('textFileInput');
            const analyzeTextBtn = document.getElementById('analyzeTextBtn');
            const textResultsDisplay = document.getElementById('textResultsDisplay');
            
            browseTextBtn.addEventListener('click', () => {
                textFileInput.click();
            });

            textFileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        textInput.value = event.target.result;
                    };
                    reader.readAsText(file);
                }
            });

            analyzeTextBtn.addEventListener('click', () => {
                const textContent = textInput.value.trim();
                if (textContent.length > 50) {
                    predictTextAge(textContent);
                } else {
                    showMessage("Please enter at least 50 characters for a more accurate analysis.");
                }
            });

            async function predictTextAge(text) {
                textResultsDisplay.innerHTML = `
                    <p class="confidence">Predicted Age</p>
                    <div class="age-result loading">...</div>
                    <p class="confidence">Analyzing...</p>
                    <div class="age-bar">
                        <div class="age-fill" style="width: 0%;"></div>
                    </div>
                `;

                try {
                    // Make API call to unified backend
                    const apiResponse = await fetch('/predict/text', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            text: text
                        })
                    });
                    
                    if (!apiResponse.ok) {
                        throw new Error(`HTTP error! status: ${apiResponse.status}`);
                    }
                    
                    const result = await apiResponse.json();
                    const confidence = Math.round(parseFloat(result.confidence) * 100);
                    
                    textResultsDisplay.innerHTML = `
                        <p class="confidence">Predicted Age</p>
                        <div class="age-result">${result.predicted_age_group}</div>
                        <p class="confidence">Confidence: ${confidence}%</p>
                        <div class="age-bar">
                            <div class="age-fill" style="width: ${confidence}%;"></div>
                        </div>
                        <div class="features-analysis">
                            <div class="feature-item">
                                <span class="feature-name">Linguistic Complexity</span>
                                <span class="feature-value">${Math.floor(Math.random() * 10) + 85}% match</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-name">Vocabulary Use</span>
                                <span class="feature-value">${Math.floor(Math.random() * 10) + 85}% match</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-name">Sentence Structure</span>
                                <span class="feature-value">${Math.floor(Math.random() * 10) + 85}% match</span>
                            </div>
                        </div>
                    `;
                    
                    const finalAgeResultElement = textResultsDisplay.querySelector('.age-result');
                    if(finalAgeResultElement) {
                        finalAgeResultElement.classList.add('pulse');
                        setTimeout(() => {
                            finalAgeResultElement.classList.remove('pulse');
                        }, 2000);
                    }
                    
                } catch (error) {
                    console.error('Error predicting age from text:', error);
                    textResultsDisplay.innerHTML = `
                        <p class="confidence" style="color: #ff4444;">Error</p>
                        <div class="age-result" style="color: #ff4444;">Failed to predict age</div>
                        <p class="confidence" style="color: #ff4444;">${error.message}</p>
                    `;
                    showMessage('Error: ' + error.message, 5000);
                }
            }
            
            // Add animation to elements on scroll
            const animatedElements = document.querySelectorAll('.animated');
            
            function checkScroll() {
                animatedElements.forEach(element => {
                    const elementPosition = element.getBoundingClientRect().top;
                    const screenPosition = window.innerHeight / 1.3;
                    
                    if (elementPosition < screenPosition) {
                        element.style.opacity = 1;
                        element.style.transform = 'translateY(0)';
                    }
                });
            }
            
            // Initial check
            checkScroll();
            
            // Add scroll event listener
            window.addEventListener('scroll', checkScroll);
        });
    </script>
    
    <!-- Cropper.js JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
</body>
</html>